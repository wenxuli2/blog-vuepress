(window.webpackJsonp=window.webpackJsonp||[]).push([[194],{672:function(s,t,e){"use strict";e.r(t);var a=e(20),n=Object(a.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"构建系统概览"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#构建系统概览"}},[s._v("#")]),s._v(" 构建系统概览")]),s._v(" "),e("p",[s._v("Electron 使用 "),e("a",{attrs:{href:"https://gn.googlesource.com/gn",target:"_blank",rel:"noopener noreferrer"}},[s._v("GN"),e("OutboundLink")],1),s._v(" 生成项目，并用 "),e("a",{attrs:{href:"https://ninja-build.org/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Ninja"),e("OutboundLink")],1),s._v(" 完成构建。 项目配置位于 "),e("code",[s._v(".gn")]),s._v(" 和 "),e("code",[s._v(".gni")]),s._v(" 文件中。")]),s._v(" "),e("h2",{attrs:{id:"gn-文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#gn-文件"}},[s._v("#")]),s._v(" GN 文件")]),s._v(" "),e("p",[s._v("The following "),e("code",[s._v("gn")]),s._v(" files contain the main rules for building Electron:")]),s._v(" "),e("ul",[e("li",[e("code",[s._v("BUILD.gn")]),s._v(" 指明了如何构建 Electron，还包括与 Chromium 相关的默认配置。")]),s._v(" "),e("li",[e("code",[s._v("build/args/{debug,release,all}.gn")]),s._v(" 包含 Electron 的默认构建参数。")])]),s._v(" "),e("h2",{attrs:{id:"分块构建"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#分块构建"}},[s._v("#")]),s._v(" 分块构建")]),s._v(" "),e("p",[s._v("由于 Chromium 项目及其庞大，最终的链接阶段往往需要数分钟，加大了开发难度。 为此，Chromium 采用了“分块构建”方式，将每个模块作为单独的动态库构建，虽然影响了文件大小和性能，但加快了链接速度，")]),s._v(" "),e("p",[s._v("Electron 也继承了 Chromium 这一构建方式。 在 "),e("code",[s._v("Debug")]),s._v(" 模式下构建时，程序将与 Chromium 的动态库链接，以加快链接速度；而 "),e("code",[s._v("Release")]),s._v(" 模式下程序则会与静态库链接，以优化程序大小和性能。")]),s._v(" "),e("h2",{attrs:{id:"测试"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#测试"}},[s._v("#")]),s._v(" 测试")]),s._v(" "),e("p",[e("strong",[s._v("注意：")]),s._v("_此内容已经过时，部分信息对于使用 GN 构建的 Electron 已不再适用。")]),e("p"),s._v(" "),e("p",[s._v("使用以下方式测试你的修改符合项目编码风格：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" run lint\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("测试功能使用：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("每当您更改Electron源代码时，都需要在测试之前重新运行构建：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" run build "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("你可以通过分离特定的测试来让测试套件运行速度更快或阻止你目前正在使用摩卡的 "),e("a",{attrs:{href:"https://mochajs.org/#exclusive-tests",target:"_blank",rel:"noopener noreferrer"}},[s._v("独占性测试"),e("OutboundLink")],1),s._v("功能. 追加 "),e("code",[s._v(".only")]),s._v(" 到任何 "),e("code",[s._v("describe")]),s._v(" 或 "),e("code",[s._v("it")]),s._v(" 函数调用：")]),s._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[s._v("describe"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("only")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'some feature'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ... only tests in this block will be run")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("或者，您可以使用 mocha 的 "),e("code",[s._v("grep")]),s._v(" 选项来只运行与给定正则表达式模式匹配的测试")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" -- --grep child_process\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("包含本地模块(例如"),e("code",[s._v("runas")]),s._v(")的测试无法在调试版本中执行 (查看 "),e("a",{attrs:{href:"https://github.com/electron/electron/issues/2558",target:"_blank",rel:"noopener noreferrer"}},[s._v("#2558"),e("OutboundLink")],1),s._v(" 获取详情), 但它们将与发行版本一起使用。")]),s._v(" "),e("p",[s._v("要使用发行构建来运行测试：")]),s._v(" "),e("div",{staticClass:"language-sh line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[s._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" -- -R\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])}),[],!1,null,null,null);t.default=n.exports}}]);