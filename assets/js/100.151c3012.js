(window.webpackJsonp=window.webpackJsonp||[]).push([[100],{577:function(e,s,t){"use strict";t.r(s);var r=t(20),n=Object(r.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h2",{attrs:{id:"class-serviceworkers"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#class-serviceworkers"}},[e._v("#")]),e._v(" Class: ServiceWorkers")]),e._v(" "),t("blockquote",[t("p",[e._v("从活跃的 service worker 会话中查询和接收事件")])]),e._v(" "),t("p",[e._v("Process: "),t("RouterLink",{attrs:{to:"/《Electron中文文档》/glossary.html#main-process"}},[e._v("Main")]),t("br"),e._v(" "),t("em",[e._v("This class is not exported from the "),t("code",[e._v("'electron'")]),e._v(" module. It is only available as a return value of other methods in the Electron API.")])],1),e._v(" "),t("p",[e._v("通过"),t("code",[e._v("Session")]),e._v("的"),t("code",[e._v("serviceWorkers")]),e._v("属性来访问"),t("code",[e._v("ServiceWorkers")]),e._v("的实例")]),e._v(" "),t("p",[e._v("例如：")]),e._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" session "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("require")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'electron'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Get all service workers.")]),e._v("\nconsole"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("session"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("defaultSession"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("serviceWorkers"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("getAllRunning")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Handle logs and get service worker info")]),e._v("\nsession"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("defaultSession"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("serviceWorkers"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'console-message'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[e._v("event"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" messageDetails")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  console"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'Got service worker message'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    messageDetails"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'from'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    session"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("defaultSession"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("serviceWorkers"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("getFromVersionID")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("messageDetails"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("versionId"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br"),t("span",{staticClass:"line-number"},[e._v("9")]),t("br"),t("span",{staticClass:"line-number"},[e._v("10")]),t("br"),t("span",{staticClass:"line-number"},[e._v("11")]),t("br"),t("span",{staticClass:"line-number"},[e._v("12")]),t("br"),t("span",{staticClass:"line-number"},[e._v("13")]),t("br"),t("span",{staticClass:"line-number"},[e._v("14")]),t("br")])]),t("h3",{attrs:{id:"实例事件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#实例事件"}},[e._v("#")]),e._v(" 实例事件")]),e._v(" "),t("p",[t("code",[e._v("ServiceWorkers")]),e._v("实例中有下列事件：")]),e._v(" "),t("h4",{attrs:{id:"event-console-message"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#event-console-message"}},[e._v("#")]),e._v(" Event: 'console-message'")]),e._v(" "),t("p",[e._v("返回:")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("event")]),e._v(" Event")]),e._v(" "),t("li",[t("code",[e._v("messageDetails")]),e._v(" Object - 有关控制台消息的信息\n"),t("ul",[t("li",[t("code",[e._v("message")]),e._v(" String - 实际控制台消息")]),e._v(" "),t("li",[t("code",[e._v("versionId")]),e._v(" Number - 发送消息日志的 service worker 的版本 ID")]),e._v(" "),t("li",[t("code",[e._v("source")]),e._v(" String - 消息源的类型  可以是 "),t("code",[e._v("javascript")]),e._v(", "),t("code",[e._v("xml")]),e._v(", "),t("code",[e._v("network")]),e._v(", "),t("code",[e._v("console-api")]),e._v(", "),t("code",[e._v("storage")]),e._v(", "),t("code",[e._v("app-cache")]),e._v(", "),t("code",[e._v("rendering")]),e._v(", "),t("code",[e._v("security")]),e._v(", "),t("code",[e._v("deprecation")]),e._v(", "),t("code",[e._v("worker")]),e._v(", "),t("code",[e._v("violation")]),e._v(", "),t("code",[e._v("intervention")]),e._v(", "),t("code",[e._v("recommendation")]),e._v(" 或 "),t("code",[e._v("other")]),e._v(".")]),e._v(" "),t("li",[t("code",[e._v("level")]),e._v(" Number - 日志等级，从 0 到 3 。 按顺序匹配 "),t("code",[e._v("verbose")]),e._v(", "),t("code",[e._v("info")]),e._v(", "),t("code",[e._v("warning")]),e._v(" 和 "),t("code",[e._v("error")]),e._v(".")]),e._v(" "),t("li",[t("code",[e._v("sourceUrl")]),e._v(" String - 消息来源的URL")]),e._v(" "),t("li",[t("code",[e._v("lineNumber")]),e._v(" Number - 触发当前控制台消息的源代码行数")])])])]),e._v(" "),t("p",[e._v("当一个service worker记录日志到控制台的时候将自动触发此事件")]),e._v(" "),t("h4",{attrs:{id:"event-registration-completed"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#event-registration-completed"}},[e._v("#")]),e._v(" Event: 'registration-completed'")]),e._v(" "),t("p",[e._v("返回:")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("event")]),e._v(" Event")]),e._v(" "),t("li",[t("code",[e._v("details")]),e._v(" Object - 有关 service worker 注册的信息\n"),t("ul",[t("li",[t("code",[e._v("scope")]),e._v(" String - 当前 service worker 所注册在的URL")])])])]),e._v(" "),t("p",[e._v("当一个service worker已经被注册完成的时候触发此事件。 注册完成分两种情况， 一个是调用"),t("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerContainer/register",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("navigator.serviceWorker.register('/sw.js')")]),t("OutboundLink")],1),e._v("方法成功，另一个是当Chrome的扩展加载结束。")]),e._v(" "),t("h3",{attrs:{id:"实例方法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#实例方法"}},[e._v("#")]),e._v(" 实例方法")]),e._v(" "),t("p",[e._v("在"),t("code",[e._v("ServiceWorkers")]),e._v("实例对象中，有以下方法:")]),e._v(" "),t("h4",{attrs:{id:"serviceworkers-getallrunning"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#serviceworkers-getallrunning"}},[e._v("#")]),e._v(" "),t("code",[e._v("serviceWorkers.getAllRunning()")])]),e._v(" "),t("p",[e._v("返回 "),t("code",[e._v("Record<Number, ServiceWorkerInfo>")]),e._v(" ， 一个 "),t("RouterLink",{attrs:{to:"/《Electron中文文档》/api/structures/service-worker-info.html"}},[e._v("ServiceWorkerInfo")]),e._v(" 对象， 其中键是 service worker 的版本 ID ，值是 service worker 的信息。")],1),e._v(" "),t("h4",{attrs:{id:"serviceworkers-getfromversionid-versionid"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#serviceworkers-getfromversionid-versionid"}},[e._v("#")]),e._v(" "),t("code",[e._v("serviceWorkers.getFromVersionID(versionId)")])]),e._v(" "),t("ul",[t("li",[t("code",[e._v("versionId")]),e._v(" Number")])]),e._v(" "),t("p",[e._v("返回 "),t("RouterLink",{attrs:{to:"/《Electron中文文档》/api/structures/service-worker-info.html"}},[t("code",[e._v("ServiceWorkerInfo")])]),e._v(" - service worker的相关信息")],1),e._v(" "),t("p",[e._v("如果 service worker 不存在或者停止运行，此方法将抛出异常。")])])}),[],!1,null,null,null);s.default=n.exports}}]);