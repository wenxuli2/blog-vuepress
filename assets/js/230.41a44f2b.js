(window.webpackJsonp=window.webpackJsonp||[]).push([[230],{708:function(e,s,t){"use strict";t.r(s);var a=t(20),n=Object(a.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"electron-fuses"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#electron-fuses"}},[e._v("#")]),e._v(" Electron Fuses")]),e._v(" "),t("blockquote",[t("p",[e._v("Package time feature toggles")])]),e._v(" "),t("h2",{attrs:{id:"what-are-fuses"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#what-are-fuses"}},[e._v("#")]),e._v(" What are fuses?")]),e._v(" "),t("p",[e._v("For a subset of Electron functionality it makes sense to disable certain features for an entire application.  For example, 99% of apps don't make use of "),t("code",[e._v("ELECTRON_RUN_AS_NODE")]),e._v(", these applications want to be able to ship a binary that is incapable of using that feature.  We also don't want Electron consumers building Electron from source as that is both a massive technical challenge and has a high cost of both time and money.")]),e._v(" "),t("p",[e._v('Fuses are the solution to this problem, at a high level they are "magic bits" in the Electron binary that can be flipped when packaging your Electron app to enable / disable certain features / restrictions.  Because they are flipped at package time before you code sign your app the OS becomes responsible for ensuring those bits aren\'t flipped back via OS level code signing validation (Gatekeeper / App Locker).')]),e._v(" "),t("h2",{attrs:{id:"how-do-i-flip-the-fuses"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#how-do-i-flip-the-fuses"}},[e._v("#")]),e._v(" How do I flip the fuses?")]),e._v(" "),t("h3",{attrs:{id:"the-easy-way"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#the-easy-way"}},[e._v("#")]),e._v(" The easy way")]),e._v(" "),t("p",[e._v("We've made a handy module "),t("code",[e._v("@electron/fuses")]),e._v(" to make flipping these fuses easy.  Check out the README of that module for more details on usage and potential error cases.")]),e._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("require")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'@electron/fuses'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("flipFuses")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Path to electron")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("require")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'electron'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Fuses to flip")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[e._v("runAsNode")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("false")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br")])]),t("h3",{attrs:{id:"the-hard-way"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#the-hard-way"}},[e._v("#")]),e._v(" The hard way")]),e._v(" "),t("h4",{attrs:{id:"quick-glossary"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#quick-glossary"}},[e._v("#")]),e._v(" Quick Glossary")]),e._v(" "),t("ul",[t("li",[t("strong",[e._v("Fuse Wire")]),e._v(": A sequence of bytes in the Electron binary used to control the fuses")]),e._v(" "),t("li",[t("strong",[e._v("Sentinel")]),e._v(": A static known sequence of bytes you can use to locate the fuse wire")]),e._v(" "),t("li",[t("strong",[e._v("Fuse Schema")]),e._v(": The format / allowed values for the fuse wire")])]),e._v(" "),t("p",[e._v("Manually flipping fuses requires editing the Electron binary and modifying the fuse wire to be the sequence of bytes that represent the state of the fuses you want.")]),e._v(" "),t("p",[e._v("Somewhere in the Electron binary there will be a sequence of bytes that look like this:")]),e._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("| ...binary | sentinel_bytes | fuse_version | fuse_wire_length | fuse_wire | ...binary |\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("ul",[t("li",[t("code",[e._v("sentinel_bytes")]),e._v(" is always this exact string "),t("code",[e._v("dL7pKGdnNz796PbbjQWNKmHXBZaB9tsX")])]),e._v(" "),t("li",[t("code",[e._v("fuse_version")]),e._v(" is a single byte whose unsigned integer value represents the version of the fuse schema")]),e._v(" "),t("li",[t("code",[e._v("fuse_wire_length")]),e._v(" is a single byte whose unsigned integer value represents the number of fuses in the following fuse wire")]),e._v(" "),t("li",[t("code",[e._v("fuse_wire")]),e._v(" is a sequence of N bytes, each byte represents a single fuse and its state.\n"),t("ul",[t("li",[e._v('"0" (0x30) indicates the fuse is disabled')]),e._v(" "),t("li",[e._v('"1" (0x31) indicates the fuse is enabled')]),e._v(" "),t("li",[e._v('"r" (0x72) indicates the fuse has been removed and changing the byte to either 1 or 0 will have no effect.')])])])]),e._v(" "),t("p",[e._v('To flip a fuse you find its position in the fuse wire and change it to "0" or "1" depending on the state you\'d like.')]),e._v(" "),t("p",[e._v("您可以在 "),t("a",{attrs:{href:"https://github.com/electron/electron/blob/main/build/fuses/fuses.json5",target:"_blank",rel:"noopener noreferrer"}},[e._v("这里"),t("OutboundLink")],1),e._v("查看当前schema。")])])}),[],!1,null,null,null);s.default=n.exports}}]);