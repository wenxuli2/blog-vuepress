(window.webpackJsonp=window.webpackJsonp||[]).push([[258],{736:function(e,t,n){"use strict";n.r(t);var s=n(20),a=Object(s.a)({},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"测试-widevine-cdm"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#测试-widevine-cdm"}},[e._v("#")]),e._v(" 测试 Widevine CDM")]),e._v(" "),n("p",[e._v("在 Electron 中，你可以使用 Widevine CDM 库装载 Chrome 浏览器。")]),e._v(" "),n("p",[e._v("Widevine Content Decryption Modules (CDMs) are how streaming services protect content using HTML5 video to web browsers without relying on an NPAPI plugin like Flash or Silverlight. Widevine support is an alternative solution for streaming services that currently rely on Silverlight for playback of DRM-protected video content. It will allow websites to show DRM-protected video content in Firefox without the use of NPAPI plugins. The Widevine CDM runs in an open-source CDM sandbox providing better user security than NPAPI plugins.")]),e._v(" "),n("h4",{attrs:{id:"note-on-vmp"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#note-on-vmp"}},[e._v("#")]),e._v(" Note on VMP")]),e._v(" "),n("p",[e._v("As of "),n("a",{attrs:{href:"https://electronjs.org/releases#1.8.1",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("Electron v1.8.0 (Chrome v59)")]),n("OutboundLink")],1),e._v(", the below steps are may only be some of the necessary steps to enable Widevine; any app on or after that version intending to use the Widevine CDM may need to be signed using a license obtained from "),n("a",{attrs:{href:"https://www.widevine.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Widevine"),n("OutboundLink")],1),e._v(" itself.")]),e._v(" "),n("p",[e._v("Per "),n("a",{attrs:{href:"https://www.widevine.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Widevine"),n("OutboundLink")],1),e._v(":")]),e._v(" "),n("blockquote",[n("p",[e._v("Chrome 59 (and later) includes support for Verified Media Path (VMP). VMP provides a method to verify the authenticity of a device platform. For browser deployments, this will provide an additional signal to determine if a browser-based implementation is reliable and secure.")]),e._v(" "),n("p",[e._v("The proxy integration guide has been updated with information about VMP and how to issue licenses.")]),e._v(" "),n("p",[e._v("Widevine recommends our browser-based integrations (vendors and browser-based applications) add support for VMP.")])]),e._v(" "),n("p",[e._v("To enable video playback with this new restriction, "),n("a",{attrs:{href:"https://castlabs.com/open-source/downstream/",target:"_blank",rel:"noopener noreferrer"}},[e._v("castLabs"),n("OutboundLink")],1),e._v(" has created a "),n("a",{attrs:{href:"https://github.com/castlabs/electron-releases",target:"_blank",rel:"noopener noreferrer"}},[e._v("fork"),n("OutboundLink")],1),e._v(" that has implemented the necessary changes to enable Widevine to be played in an Electron application if one has obtained the necessary licenses from widevine.")]),e._v(" "),n("h2",{attrs:{id:"getting-the-library"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#getting-the-library"}},[e._v("#")]),e._v(" Getting the library")]),e._v(" "),n("p",[e._v("Open "),n("code",[e._v("chrome://components/")]),e._v(" in Chrome browser, find "),n("code",[e._v("Widevine Content Decryption Module")]),e._v(" and make sure it is up to date, then you can find the library files from the application directory.")]),e._v(" "),n("h3",{attrs:{id:"on-windows"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#on-windows"}},[e._v("#")]),e._v(" On Windows")]),e._v(" "),n("p",[e._v("The library file "),n("code",[e._v("widevinecdm.dll")]),e._v(" will be under "),n("code",[e._v("Program Files(x86)/Google/Chrome/Application/CHROME_VERSION/WidevineCdm/_platform_specific/win_(x86|x64)/")]),e._v(" directory.")]),e._v(" "),n("h3",{attrs:{id:"在-macos-中"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#在-macos-中"}},[e._v("#")]),e._v(" 在 macOS 中")]),e._v(" "),n("p",[e._v("The library file "),n("code",[e._v("libwidevinecdm.dylib")]),e._v(" will be under "),n("code",[e._v("/Applications/Google Chrome.app/Contents/Versions/CHROME_VERSION/Google Chrome Framework.framework/Versions/A/Libraries/WidevineCdm/_platform_specific/mac_(x86|x64)/")]),e._v(" directory.")]),e._v(" "),n("p",[n("strong",[e._v("Note:")]),e._v(" Make sure that chrome version used by Electron is greater than or equal to the "),n("code",[e._v("min_chrome_version")]),e._v(" value of Chrome's widevine cdm component. The value can be found in "),n("code",[e._v("manifest.json")]),e._v(" under "),n("code",[e._v("WidevineCdm")]),e._v(" directory.")]),e._v(" "),n("h2",{attrs:{id:"using-the-library"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#using-the-library"}},[e._v("#")]),e._v(" Using the library")]),e._v(" "),n("p",[e._v("After getting the library files, you should pass the path to the file with "),n("code",[e._v("--widevine-cdm-path")]),e._v(" command line switch, and the library's version with "),n("code",[e._v("--widevine-cdm-version")]),e._v(" switch. The command line switches have to be passed before the "),n("code",[e._v("ready")]),e._v(" event of "),n("code",[e._v("app")]),e._v(" module gets emitted.")]),e._v(" "),n("p",[e._v("示例代码：")]),e._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" app"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" BrowserWindow "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'electron'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// You have to pass the directory that contains widevine library here, it is")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// * `libwidevinecdm.dylib` on macOS,")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// * `widevinecdm.dll` on Windows.")]),e._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("commandLine"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("appendSwitch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'widevine-cdm-path'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'/path/to/widevine_library'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// The version of plugin can be got from `chrome://components` page in Chrome.")]),e._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("commandLine"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("appendSwitch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'widevine-cdm-version'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'1.4.8.866'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("let")]),e._v(" win "),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("null")]),e._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("whenReady")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("then")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  win "),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("new")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[e._v("BrowserWindow")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n  win"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("show")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br")])]),n("h2",{attrs:{id:"verifying-widevine-cdm-support"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#verifying-widevine-cdm-support"}},[e._v("#")]),e._v(" Verifying Widevine CDM support")]),e._v(" "),n("p",[e._v("To verify whether widevine works, you can use following ways:")]),e._v(" "),n("ul",[n("li",[e._v("打开 https://shaka-player-demo.appspot.com/ 加载一个使用 "),n("code",[e._v("Widevine")]),e._v(" 的 manifest。")]),e._v(" "),n("li",[e._v("打开 http://www.dash-player.com/demo/drm-test-area/，检查是否界面输出 "),n("code",[e._v("bitdash uses Widevine in your browser")]),e._v("，然后播放 video。")])])])}),[],!1,null,null,null);t.default=a.exports}}]);