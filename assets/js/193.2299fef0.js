(window.webpackJsonp=window.webpackJsonp||[]).push([[193],{671:function(e,t,s){"use strict";s.r(t);var r=s(20),a=Object(r.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"构建步骤-windows"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#构建步骤-windows"}},[e._v("#")]),e._v(" 构建步骤（Windows）")]),e._v(" "),s("p",[e._v("按照下面的指南在Windows下构建 "),s("strong",[e._v("Electron 本身")]),e._v("，以此创建自定义 Electron 二进制文件。 为了将您的应用代码与预构建的 Electron 二进制文件打包并发布，请参阅 "),s("RouterLink",{attrs:{to:"/《Electron中文文档》/tutorial/application-distribution.html"}},[e._v("应用程序发布")]),e._v(" 指南。")],1),e._v(" "),s("h2",{attrs:{id:"prerequisites"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[e._v("#")]),e._v(" Prerequisites")]),e._v(" "),s("ul",[s("li",[e._v("Windows 10 / Server 2012 R2 或更高版本")]),e._v(" "),s("li",[e._v("Visual Studio 2017 15.7.2 或更高版本 - "),s("a",{attrs:{href:"https://www.visualstudio.com/vs/",target:"_blank",rel:"noopener noreferrer"}},[e._v("免费下载 VS 2019 社区版"),s("OutboundLink")],1),e._v(" "),s("ul",[s("li",[e._v("请参阅"),s("a",{attrs:{href:"https://chromium.googlesource.com/chromium/src/+/master/docs/windows_build_instructions.md#visual-studio",target:"_blank",rel:"noopener noreferrer"}},[e._v("Chromium构建文档"),s("OutboundLink")],1),e._v("，以了解有哪些Visual Studio 组件需要安装等详细信息。")]),e._v(" "),s("li",[e._v("如果您的 Visual Studio 安装在非默认目录中， 您需要 设置几个环境变量来将工具链指向您的安装路径。\n"),s("ul",[s("li",[s("code",[e._v("vs2019_install = DRIVE:\\path\\to\\Microsoft Visual Studio\\2019\\Community")]),e._v("，用您当前已安装版本替换"),s("code",[e._v("2019")]),e._v("和"),s("code",[e._v("Community")]),e._v("以及用您当前安装Visual Studio的驱动器号替换"),s("code",[e._v("DRIVE:")]),e._v(" 一般情况下将会是"),s("code",[e._v("C:")]),e._v("。")]),e._v(" "),s("li",[s("code",[e._v("WINDOWSSDKDIR = DRIVE:\\path\\to\\Windows Kits\\10")]),e._v(", replacing "),s("code",[e._v("DRIVE:")]),e._v(" with the drive that Windows Kits is on. 一般情况下将会是"),s("code",[e._v("C:")]),e._v("。")])])]),e._v(" "),s("li",[s("a",{attrs:{href:"https://pypi.org/project/pywin32/#files",target:"_blank",rel:"noopener noreferrer"}},[e._v("Python for Windows (pywin32) 扩展"),s("OutboundLink")],1),e._v("对于构建流程也是必需的。")])])]),e._v(" "),s("li",[s("a",{attrs:{href:"https://nodejs.org/download/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Node.js"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://git-scm.com",target:"_blank",rel:"noopener noreferrer"}},[e._v("Git"),s("OutboundLink")],1)]),e._v(" "),s("li",[e._v("Debugging Tools for Windows of Windows SDK 10.0.15063.468 if you plan on creating a full distribution since "),s("code",[e._v("symstore.exe")]),e._v(" is used for creating a symbol store from "),s("code",[e._v(".pdb")]),e._v(" files.\n"),s("ul",[s("li",[e._v("不同版本的SDK可以同时安装 To install the SDK, open Visual Studio Installer, select "),s("code",[e._v("Modify")]),e._v(" → "),s("code",[e._v("Individual Components")]),e._v(", scroll down and select the appropriate Windows SDK to install. 另一个选择是查看 "),s("a",{attrs:{href:"https://developer.microsoft.com/en-us/windows/downloads/sdk-archive",target:"_blank",rel:"noopener noreferrer"}},[e._v("windows SDK 和仿真器存档"),s("OutboundLink")],1),e._v(" 并分别下载 SDK 的独立版本。")]),e._v(" "),s("li",[e._v("还必须安装 SDK 调试工具。 如果已安装了 Windows 10 SDK 通过 Visual Studio 安装程序，然后可以用以下方式安装它们： "),s("code",[e._v("控制面板")]),e._v("→"),s("code",[e._v("程序")]),e._v("→"),s("code",[e._v("程序和功能")]),e._v("→选择“Windows 软件开发工具包”→ "),s("code",[e._v("更改")]),e._v("→"),s("code",[e._v("更改")]),e._v("→选中“Windows 调试工具”→"),s("code",[e._v("更改")]),e._v("。 或者，您可以下载独立的 SDK 安装程序，并且使用它安装调试工具。")])])])]),e._v(" "),s("p",[e._v("如果您当前没有安装 Windows， "),s("a",{attrs:{href:"https://developer.microsoft.com/en-us/microsoft-edge/tools/vms/",target:"_blank",rel:"noopener noreferrer"}},[e._v("dev.microsoftedge.com"),s("OutboundLink")],1),e._v(" 上有时间限制的 Windows 版本，你可以用来构建 Electron。")]),e._v(" "),s("p",[e._v("构建 Electron 完全由命令行脚本完成，无法通过 Visual Studio 完成。 您可以使用任何编辑器开发 Electron，但将来将会使用 Visual Studio 构建支持。")]),e._v(" "),s("p",[s("strong",[e._v("注意:")]),e._v(" 即使 Visual Studio 不用于构建，但是仍然"),s("strong",[e._v("需要")]),e._v("，因为我们需要它提供的构建工具链。")]),e._v(" "),s("h2",{attrs:{id:"从windows-security排除source-tree"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#从windows-security排除source-tree"}},[e._v("#")]),e._v(" 从Windows Security排除source tree")]),e._v(" "),s("p",[e._v("Windows Security 不支持Chromium 源码中部分代码，详情(see https://crbug.com/441184). 此行为将会导致windows系统会删除Chromium里的危险文件从而导致 "),s("code",[e._v("gclient sync")]),e._v(" Bug. 通过"),s("a",{attrs:{href:"https://support.microsoft.com/en-us/windows/add-an-exclusion-to-windows-security-811816c0-4dfd-af4a-47e4-c301afe13b26",target:"_blank",rel:"noopener noreferrer"}},[e._v("following these instructions"),s("OutboundLink")],1),e._v("你可以在Windows Security中排除这一行为。")]),e._v(" "),s("h2",{attrs:{id:"构建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#构建"}},[e._v("#")]),e._v(" 构建")]),e._v(" "),s("p",[e._v("参照"),s("RouterLink",{attrs:{to:"/《Electron中文文档》/development/build-instructions-gn.html"}},[e._v("Build Instructions: GN")])],1),e._v(" "),s("h2",{attrs:{id:"_32-位构建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_32-位构建"}},[e._v("#")]),e._v(" 32 位构建")]),e._v(" "),s("p",[e._v("为了构建 32bit 版本，您需要通过 "),s("code",[e._v('target_cpu = “x86"')]),e._v(" 作为 GN 参数。 可以使用不同的 GN 输出目录（例如， "),s("code",[e._v("out/Release-x86")]),e._v("） 和不同的参数，在 64 位目标旁边构建 32 位目标。")]),e._v(" "),s("div",{staticClass:"language-powershell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[e._v("$ gn gen out/Release-x86 "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("--")]),e._v("args="),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"import(\\"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v("electron/build/args/release"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("gn\\"),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('") target_cpu=\\"')]),e._v("x86\\"),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('""')]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("其他构建步骤完全一样。")]),e._v(" "),s("h2",{attrs:{id:"visual-studio-项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#visual-studio-项目"}},[e._v("#")]),e._v(" Visual Studio 项目")]),e._v(" "),s("p",[e._v("要生成 Visual Studio 项目，可以传递 "),s("code",[e._v("--ide=vs2017")]),e._v(" 参数 给 "),s("code",[e._v("gn gen")]),e._v("：")]),e._v(" "),s("div",{staticClass:"language-powershell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[e._v("$ gn gen out/Testing "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("--")]),e._v("ide=vs2017\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h2",{attrs:{id:"故障排查"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#故障排查"}},[e._v("#")]),e._v(" 故障排查")]),e._v(" "),s("h3",{attrs:{id:"command-xxxx-not-found"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#command-xxxx-not-found"}},[e._v("#")]),e._v(" Command xxxx not found")]),e._v(" "),s("p",[e._v("如果你遇到了一个错误，类似 "),s("code",[e._v("Command xxxx not found")]),e._v(", 可以尝试使用 "),s("code",[e._v("VS2015 Command Prompt")]),e._v(" 控制台来执行构建脚本.")]),e._v(" "),s("h3",{attrs:{id:"fatal-internal-compiler-error-c1001"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#fatal-internal-compiler-error-c1001"}},[e._v("#")]),e._v(" Fatal internal compiler error: C1001")]),e._v(" "),s("p",[e._v("确保你已经安装了 Visual Studio 的最新安装包.")]),e._v(" "),s("h3",{attrs:{id:"lnk1181-cannot-open-input-file-kernel32-lib"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#lnk1181-cannot-open-input-file-kernel32-lib"}},[e._v("#")]),e._v(" LNK1181: cannot open input file 'kernel32.lib'")]),e._v(" "),s("p",[e._v("重新安装 32位的 Node.js.")]),e._v(" "),s("h3",{attrs:{id:"error-enoent-stat-c-users-username-appdata-roaming-npm"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#error-enoent-stat-c-users-username-appdata-roaming-npm"}},[e._v("#")]),e._v(" Error: ENOENT, stat 'C:\\Users\\USERNAME\\AppData\\Roaming\\npm'")]),e._v(" "),s("p",[e._v("创建那个目录 "),s("a",{attrs:{href:"https://stackoverflow.com/a/25095327/102704",target:"_blank",rel:"noopener noreferrer"}},[e._v("应该可以解决问题"),s("OutboundLink")],1),e._v(":")]),e._v(" "),s("div",{staticClass:"language-powershell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[e._v("$ mkdir ~\\AppData\\Roaming\\npm\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h3",{attrs:{id:"node-gyp-is-not-recognized-as-an-internal-or-external-command"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#node-gyp-is-not-recognized-as-an-internal-or-external-command"}},[e._v("#")]),e._v(" node-gyp is not recognized as an internal or external command")]),e._v(" "),s("p",[e._v("如果你使用 Git Bash 来构建，或许会遇到这个错误，可以使用 PowerShell 或 VS2015 Command Prompt 来代替.")]),e._v(" "),s("h3",{attrs:{id:"无法在-处创建目录-文件名太长"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#无法在-处创建目录-文件名太长"}},[e._v("#")]),e._v(" 无法在“…”处创建目录：文件名太长")]),e._v(" "),s("p",[e._v("node.js 有一些 "),s("a",{attrs:{href:"https://github.com/electron/node/tree/electron/deps/npm/node_modules/libnpx/node_modules/yargs/node_modules/read-pkg-up/node_modules/read-pkg/node_modules/load-json-file/node_modules/parse-json/node_modules/error-ex/node_modules/is-arrayish",target:"_blank",rel:"noopener noreferrer"}},[e._v("极长的路径名"),s("OutboundLink")],1),e._v("，默认情况下，windows 上的 git 不能正确处理长路径名（即使 windows 支持它们）。 这应该可以修复它：")]),e._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" config --system core.longpaths "),s("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("true")]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h3",{attrs:{id:"错误-使用未声明的标识符-defaultdelegatecheckmode"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#错误-使用未声明的标识符-defaultdelegatecheckmode"}},[e._v("#")]),e._v(" 错误：使用未声明的标识符“DefaultDelegateCheckMode”")]),e._v(" "),s("p",[e._v("This can happen during build, when Debugging Tools for Windows has been installed with Windows Driver Kit. Uninstall Windows Driver Kit and install Debugging Tools with steps described above.")]),e._v(" "),s("h3",{attrs:{id:"导入错误-没有名为-win32file-的模块"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#导入错误-没有名为-win32file-的模块"}},[e._v("#")]),e._v(" 导入错误：没有名为 win32file 的模块")]),e._v(" "),s("p",[e._v("确保已使用 "),s("code",[e._v("pip install pywin32")]),e._v(" 安装了 "),s("code",[e._v("pywin32")]),e._v("。")]),e._v(" "),s("h3",{attrs:{id:"构建脚本挂起-直到某个按键按下才有响应"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#构建脚本挂起-直到某个按键按下才有响应"}},[e._v("#")]),e._v(" 构建脚本挂起, 直到某个按键按下才有响应")]),e._v(" "),s("p",[e._v('这个bug 是 Windows 命令提示符的一个"功能" It happens when clicking inside the prompt window with '),s("code",[e._v("QuickEdit")]),e._v(" enabled and is intended to allow selecting and copying output text easily. 由于每次意外点击都会暂停构建过程，您可能需要在命令的属性中禁用此 功能。")])])}),[],!1,null,null,null);t.default=a.exports}}]);